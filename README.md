Проект работает только под Java 1.8, так как используется Ignite версии 2. Версию Ignite 2.7.6 подобрал под 8-ю java, которую удалось скачать - openlogic-openjdk-8u452-b09-windows-x64

Задача 1:

Тестовый скрипт реализован в TestScriptApplication. Пример вывода в лог приведен в output.txt в корне проекта и вывод первых 3-х строк отличается. Причины этого описаны ниже

Проверка как классы работают в многопоточном режиме производится в OraclePackagesTest. Тест запускает строго одновременно и параллельно 4 потока вычислений.

Код несовместим с реактивными фреймворками типа ProjectReactor, так как в нем используется ThreadLocal

Код использует класс-обертку DefaultRateHolder для хранения defaultRate в ThreadLocal и класс-обертку DoubleHolder для примитива double. Класс DefaultRateHolder нужен, чтоб избежать циклических зависимостей, а DoubleHolder, чтоб избежать boxing/unboxing

По причине того что перестроены зависимости классов инициализация происходит в другом порядке и вывод первых 3-х строк отличается

Есть проблемы с default-значениями параметров методов пакетов:
 1) Не все комбинации можно покрыть перегрузкой методов (речь о calculateInterest в ClassB) и нужно в некоторых случаях явно передавать значения, которые в Oracle передаются по дефолту
 2) В Oracle, если явно передан null, то не применяется значение по дефолту. В моей реализации, если значение не передано, то считается, что передан null, а когда передан null применяется значение по дефолту. То есть, строго говоря реализация отличается и предполагается, что разработчики, которые используют API, это знают и передают значения параметров с учетом этой особенности. В случаях, когда точно нельзя считать null дефолтным значением, то вместо null в качестве признака дефолтного значения можно использовать, например, Double.MIN_VALUE  

Код использует Spring Boot. Можно было бы обойтись без него, но реализация с использованием Spring ближе к реальной ситуации


Задача 2:

Автономные транзакции используются для записи в таблицу аудита или если есть какая-то долгая процедура вычислений и надо сохранять ее промежуточные результаты

Запустить автономную транзакцию Ignite в том же потоке, что и основную нельзя, исходя из того, что я прочитал в документации (прогуглил)

Автономные транзакции реализованы в классе AutonomousTransaction и их работа проверяется в тесте AutonomousTransactionTest

В примере класс AutonomousTransaction оперирует с конкретным кэшом, где ключ и значение строка. Так сделано просто потому, что это пример. Можно было бы сделать пример, где в рамках транзакции вносятся изменения в разные кэши

Поскольку, если в Oracle вызвать вложенную процедуру с автономной транзакцией из главной процедуры, то вложенная выполняется в том же потоке, то и в классе AutonomousTransaction реализован именно синхронный вариант

Для полной изоляции автономной транзакции можно было бы использовать уровень SERIALIZABLE, но это более дорогой по затратам режим. Можно было бы передавать уровень изоляции как параметр, но, опять же, поскольку это пример, то суперуниверсальным я его делать не стал